#
# This is the Apache configuration for the Disk Pool Manager (DPM) HTTP/DAV module.
#

# To use the DPM DAV module you need to enable the SSL directives below.
# You can do it either by uncommenting the lines below (and updating the values if requires),
# or by doing it in the ssl.conf file directly.
<IfModule ssl_module>
  # Path to the CA certificates (change as appropriate if your CA certificates are elsewhere)
  # SSLCACertificatePath /etc/grid-security/certificates

  # This improves HTTPS performance when the client disables encryption
  # SSLCipherSuite NULL-MD5:NULL:RC4-MD5:RC4:+LOW:+MEDIUM:+HIGH:+EXP
  # SSLHonorCipherOrder on

  # Client verification should be at least optional (see ssl.conf for more information)
  # SSLVerifyClient require
  # SSLVerifyDepth  10
</IfModule>

# Required DAV modules for the Apache frontend.
<IfModule !dav_module>
  LoadModule dav_module       /usr/lib/apache2/modules/mod_lcgdm_dav.so
</IfModule>

# DMLite configuration file
NSDMLite /etc/ugr/ugrdmlite.conf

# Head, disk, or lfc. For the ugr, this has to be 'lfc'
NSType lfc

# Alias for the delegation
ScriptAlias /gridsite-delegation "/usr/sbin/gridsite-delegation.cgi"

# DPM/LFC DAV location
<Location /myfed>

  # Enable DPM DAV here
  DAV nameserver 


  # None, one or several flags
  # Write           Enable write access
  # DiskDirAllow    Disk hosts can serve directories
  # DiskDirRedirect Disk hosts will redirect to DPMHost when a directory is requested
  # RemoteCopy      Allow the COPY method
  #DMFlags

  # Where delegation proxies are stored. This is hard-coded in the GridSite
  # CGI, it allways has to be DocumentRoot/../proxycache
  #ProxyCache /var/proxycache

  # DMToken password <passwd> Use passwd to encrypt the hash used to validate requests.
  #                           Not very secure.
  # DMToken passfile <file>   Use the password contained in the file to encrypt the hash.
  #                           More secure. External methods can be used to renew periodically,
  #                           incrementing security.
  #DMToken password changethis

  # On redirect, maximum number of replicas in the URL
  NSMaxReplicas 3

  # Delegation service. If it does not start with http:/https:,
  # https will be assumed, and the host name appended.
  # ProxyDelegationService /gridsite-delegation

  # Where the proxies are cached
  # ProxyCache /var/www/proxycache

  # User for anonymous access to the federation (not to the data or to the storage endpoints!)
  NSAnon nobody

</Location>

# Static content
Alias /static/ /usr/share/lcgdm-dav/

# Compress text output (i.e. directory listings)
# This can reduce really _a_lot_ the response time for big directories.
AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css


